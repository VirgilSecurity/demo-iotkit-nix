#!/bin/bash

SCRIPT_FOLDER="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

#***************************************************************************************
check_error() {
   RETRIES=$?
   if [ $RETRIES != 0 ]; then
        echo "----------------------------------------------------------------------"
        echo "############# !!! PROCESS ERROR ERRORCODE=[$RETRIES]  #################"
        echo "----------------------------------------------------------------------"
        [ "$1" == "0" ] || exit $RETRIES
   else
        echo "-----# Process OK. ---------------------------------------------------"
   fi
   return $RETRIES
}

#***************************************************************************************

# Cd root project path
cd "${SCRIPT_FOLDER}/../../"

#***************************************************************************************
echo "----------------------------------------------------------------------"
echo "############# CHECK WITH CPPCHECK ####################################"
echo "----------------------------------------------------------------------"
cppcheck --enable=warning,information --inline-suppr --error-exitcode=128 --report-progress -q -D DEBUGV \
                -i"ext" \
                "app" \
                "initializer" \
                "shared" \
                "tests"
check_error

echo "----------------------------------------------------------------------"
echo "#############  CPPCHECK DONE #########################################"
echo "----------------------------------------------------------------------"
